<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Simple Upload to S3</title>
<script src="./dist/flexio.js"></script>

<script>
window.onload = function() {

    // setup Flexio SDK with our API key
    Flexio.setup('xtdkxpcjwzkpgkhkcmhx', { baseUrl: 'https://localhost/api/v1', debug: true, insecure: true })

    var form = document.getElementById('upload-form')
    form.onsubmit = function() {
        var formdata = new FormData(form)
        
        var pipe = Flexio.pipe()
            .set('filename', '${uniqid}')
            .read("context://files/myfile")
            .write("/flexio-filetrans-demo2/${filename}")
            .echo('https://s3.amazonaws.com/flexio-filetrans-demo/${filename}')
        .run({ data: formdata }, function(err, response) {
            document.getElementById('info').innerHTML = "Your download link is: " + response.text
        })

        return false // prevent default form processing
    }
}
</script>
</head>

<body>
<form id="upload-form">
<input type="file" name="myfile">
<input type="submit" value="Run Pipe"></p>
</form>

<div id="info"/>

</body>
</html>
